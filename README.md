# utools fragment paste

### 介绍
一个基于桌面端效率工具 utools 的插件，将预定的文本碎片快速粘贴到所需位置

### 前置准备
1.  **安装 utools**：该项目是 [utools](https://u.tools/) 的一个插件，自然必须先安装 utools
2.  **Node 环境**：测试 [Node.js](https://nodejs.org/en/) 环境为 V19.17.0

### 使用说明
1.  **创建碎片文档存储文件**：在项目 doc 目录下，创建一个 excel 文件，在该文件中完成所有的文档碎片的预定工作，详情参见下文
2.  **安装依赖**：在终端运行 ```npm install```，安装所需依赖（read-excel-file）
3.  **加载插件**：安装好 utools 后，通过快捷键```Alt + Space```呼出 utools 框，打开插件系统，先安装、运行 utools 开发者工具，选择本项目中的 plugin.json 文件，开启运行
4.  **更新存储数据**：通过快捷键```Alt + Space```呼出 utools 框，输入自定义的更新存储数据库的指令，如本插件实例中输入 du，选择更新 demo 的选项，等待系统弹出更新完成的弹窗通知即可
5.  **使用插件**：重新呼出 utools 窗体，输入自己预定义的关键词，选择对应的选项，粘贴文本，如本插件中示例，在 utools 窗体中输入 d，即可使用预定义的 demo 代码片段

### 预设文档碎片存储文档的定义规则
1. 所有的文档碎片都由用户预先定义在一个 excel 文件当中，插件在进行更新操作时，会自动读取该 excel 文件，将该文件中的文件更新到插件系统的数据库中
2. excel 文件当中，每一行为一个具体的文档碎片，每一行对应有三列，每列务必按照对应的含义来定义
	+ 第一列为文档碎片的标题
	+ 第二列为文档碎片的简要描述
	+ 第三列为文档碎片的具体内容

### 预设定义规则
1. 在 plugin.json 文件中，对选项数组 features 添加一组 选项，该组原想包含 2 个对象选项，分别为预设片段类型和更新片段数据库，如下：
	```
	{
	  "code": "demo",  				// 某个具体 预设片段类型 的特定识别码
	  "cmds": ["d"],				// 在 utools 窗体中触发该类型预设的关键词，支持中文
	  "explain": "demo 示例文档碎片"		// 对该类型预设的简要描述
	},
	{
	  "code": "demo_update",  			// 某个具体 更新数据库操作 的特定识别码
	  "cmds": ["du"],					// 在 utools 窗体中触发该更新数据库操作的关键词，支持中文
	  "explain": "更新 demo 文档数据库"	// 对该更新操作的简要描述
	},
	```
2. 在 types.js 中的导出数组中，添加 预设片段类型名 的字符串元素，字符串的值同上述添加的对象中的 code 值，如示例中的 demo
3. 在 doc 文件夹下，创建一个 excel 文件，文件名为 预设片段类型，后缀名为 .xlsx，如示例中的 demo.xlsx

### 注意:
1. 预设规则中的如下 3 个值 务必 设置为相同的值，如示例中的 demo：
	+ plugin.json 中 features 数组，每添加的文档碎片类型对象中的 code 值
	+ types.js 导出数组中添加的新元素值
	+ doc 文件夹下预设 excel 存储文件的文件名

2. plugin.json 文件 features 数组中，每添加的一个 更新数据库操作对象，其 code 属性值必须以对应的文档碎片类型的 code 值为开头，以 ```_updata``` 为结尾，如示例中的 "demo_update"